<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Zanzibar Schools Survey</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.48.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.48.0/mapbox-gl.css' rel='stylesheet' />

    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; z-index:-1; }

        .legend label,
        .legend span {
          display:block;
          float:left;
          height:15px;
          width:20%;
          text-align:center;
          font-size:9px;
          color:#808080;
        }
    </style>
</head>
<body>
<!-- Set the display of this container to none so we can
   add it programmatically to `legendControl` -->
   <div id='legend' style='display:none;'>
      <strong>The Title or Explanation of your Map</strong>
      <nav class='legend clearfix'>
        <span style='background:#F1EEF6;'></span>
        <span style='background:#BDC9E1;'></span>
        <span style='background:#74A9CF;'></span>
        <span style='background:#2B8CBE;'></span>
        <span style='background:#045A8D;'></span>
        <label>0 - 20%</label>
        <label>40%</label>
        <label>60%</label>
        <label>80%</label>
        <label>100%</label>
        <small>Source: <a href="#link to source">Name of source</a></small>
    </div>

    <div id='map'></div>


    <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoidmljazI1IiwiYSI6ImNqa3d6NWpxczAzN2IzcHF4eHlwZzNmcjYifQ.XNOgFms-v3P60RerHVIeUQ';

        // Set bounds to Zanzibar
        var bounds = [
            [39.06463623046875,-6.320075867055317], // Southwest coordinates
            [39.43817138671875,-5.9029208208054245]  // Northeast coordinates
        ];

        var map = new mapboxgl.Map({
            container: 'map', // container id
            style: 'mapbox://styles/vick25/cjlj8qj4u2a7h2rmoj9viljm5', // stylesheet location
            center: [39.20557022094726, -6.165302294288643], // starting position [lng, lat]
            zoom: 15, // starting zoom
            // maxBounds: bounds // Sets bounds as max
        });
        //Default cursor
        map.getCanvas().style.cursor = 'default';

        // Add zoom and rotation controls to the map.
        map.addControl(new mapboxgl.NavigationControl());

        // map.legendControl.addLegend(document.getElementById('legend').innerHTML);

        map.on('load', function() {
            // Add a new source from our GeoJSON data and set the
            // 'cluster' option to true. GL-JS will add the point_count property to your source data.
            map.addSource("schools", {
                type: "geojson",
                // Point to GeoJSON data.
                data: "https://raw.githubusercontent.com/vick25/ZMI-mapboxschools/master/Zanz-schools.geojson",
                cluster: true,
                clusterMaxZoom: 10, // Max zoom to cluster points on
                clusterRadius: 30 // Radius of each cluster when clustering points (defaults to 50)
            });

            map.addLayer({
                id: "clusters",
                type: "circle",
                source: "schools",
                filter: ["has", "point_count"],
                paint: {
                    // Use step expressions (https://www.mapbox.com/mapbox-gl-js/style-spec/#expressions-step)
                    // with three steps to implement three types of circles:
                    //   * Blue, 20px circles when point count is less than 10
                    //   * Yellow, 30px circles when point count is between 10 and 25
                    //   * Green (00BE28), 40px circles when point count is greater than or equal to 25
                    "circle-color": [
                        "step",
                        ["get", "point_count"],
                        "#51bbd6",
                        10,
                        "#f1f075",
                        25,
                        "#00BE28"
                    ],
                    "circle-radius": [
                        "step",
                        ["get", "point_count"],
                        20,
                        10,
                        30,
                        25,
                        40
                    ]
                }
            });
        });
</script>

</body>
</html>
